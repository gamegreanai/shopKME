{% extends 'base/base.html' %}
{% load static %}
{% block title %}‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà | shopKME{% endblock %}

{% block content %}
<div class="container py-4">

  <!-- üîπ ‡πÅ‡∏ñ‡∏ö Points & Level -->
  <div class="card border-0 shadow-sm rounded-4 mb-4">
    <div class="card-body d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3">
      <div>
        <span class="badge bg-success rounded-pill px-3 py-2 fs-6">
          ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å: {{ meter.level }}
        </span>
        <span class="ms-2 text-muted">
          ‡πÅ‡∏ï‡πâ‡∏°‡∏™‡∏∞‡∏™‡∏°: <strong>{{ meter.points|default:0 }}</strong> pts
        </span>
      </div>
      <div class="progress-wrapper w-100 w-md-50" style="max-width: 520px;">
        <div class="d-flex justify-content-between small mb-1">
          <span>
            {% if meter.level == "Silver" %} Silver
            {% elif meter.level == "Gold" %} Gold
            {% else %} Premium {% endif %}
          </span>
          <span>{{ meter.progress_pct }}%</span>
        </div>
        <div class="progress" style="height: 10px;">
          <div class="progress-bar bg-success" style="width: {{ meter.progress_pct }}%;"></div>
        </div>
        <div class="small text-muted mt-1">
          {% if meter.next_level_name %}
            ‡∏≠‡∏µ‡∏Å <strong>{{ meter.remain_to_next }}</strong> ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏õ‡πá‡∏ô <strong>{{ meter.next_level_name }}</strong>
          {% else %}
            ‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡πÅ‡∏•‡πâ‡∏ß üéâ
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  <!-- üîπ ‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á -->
  {% if user.first_name and user.last_name and user.email and profile.title and profile.gender and profile.house_no and profile.moo and profile.street and profile.subdistrict and profile.district and profile.province and profile.postal_code %}
  
  <!-- ‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
  <div class="card border-0 shadow-sm rounded-4 p-4">
    <h5 class="fw-bold text-success mb-4"><i class="fa fa-user me-2"></i> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</h5>
    <div class="row g-4">
      <div class="col-md-3"><strong>‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡∏∑‡πà‡∏≠</strong><div>{{ profile.title }}</div></div>
      <div class="col-md-4"><strong>‡∏ä‡∏∑‡πà‡∏≠</strong><div>{{ user.first_name }}</div></div>
      <div class="col-md-5"><strong>‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</strong><div>{{ user.last_name }}</div></div>
      <div class="col-md-3"><strong>‡πÄ‡∏û‡∏®</strong><div>{{ profile.gender }}</div></div>
      <div class="col-md-6"><strong>‡∏≠‡∏µ‡πÄ‡∏°‡∏•</strong><div>{{ user.email }}</div></div>
      <div class="col-md-6"><strong>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</strong><div>{{ user.phone }}</div></div>
      <div class="col-12"><hr></div>
      <div class="col-md-3"><strong>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡πâ‡∏≤‡∏ô</strong><div>{{ profile.house_no }}</div></div>
      <div class="col-md-2"><strong>‡∏´‡∏°‡∏π‡πà</strong><div>{{ profile.moo }}</div></div>
      <div class="col-md-7"><strong>‡∏ñ‡∏ô‡∏ô</strong><div>{{ profile.street }}</div></div>
      <div class="col-md-6"><strong>‡πÅ‡∏Ç‡∏ß‡∏á/‡∏ï‡∏≥‡∏ö‡∏•</strong><div>{{ profile.subdistrict }}</div></div>
      <div class="col-md-6"><strong>‡πÄ‡∏Ç‡∏ï/‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</strong><div>{{ profile.district }}</div></div>
      <div class="col-md-6"><strong>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</strong><div>{{ profile.province }}</div></div>
      <div class="col-md-6"><strong>‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå</strong><div>{{ profile.postal_code }}</div></div>
    </div>
  </div>

  {% else %}

  <!-- ‚úÖ ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
  <form method="post" novalidate>
    {% csrf_token %}
    {{ form.non_field_errors }}

    <!-- üî∏ ‡∏Å‡∏≤‡∏£‡πå‡∏î: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ -->
    <div class="card border-0 shadow-sm rounded-4 mb-4">
      <div class="card-body p-4">
        <h5 class="fw-bold text-success mb-4">
          <i class="fa fa-id-card me-2"></i> ‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠
        </h5>

        <div class="row g-4 align-items-end">
          <div class="col-md-2 col-sm-4">
            <label class="form-label fw-semibold text-secondary">‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤</label>
            {{ form.title }}
          </div>

          <!-- üëá ‡∏ä‡∏∑‡πà‡∏≠‚Äì‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ô -->
          <div class="col-md-10 col-sm-8">
            <div class="d-flex flex-column flex-sm-row gap-3">
              <div class="flex-fill">
                <label class="form-label fw-semibold text-secondary">‡∏ä‡∏∑‡πà‡∏≠</label>
                {{ form.first_name }}
              </div>
              <div class="flex-fill">
                <label class="form-label fw-semibold text-secondary">‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
                {{ form.last_name }}
              </div>
            </div>
          </div>

          <div class="col-md-2 col-sm-6">
            <label class="form-label fw-semibold text-secondary">‡πÄ‡∏û‡∏®</label>
            {{ form.gender }}
          </div>
          <div class="col-md-4 col-sm-6">
            <label class="form-label fw-semibold text-secondary">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
            {{ form.email }}
          </div>
          <div class="col-md-3 col-sm-6">
            <label class="form-label fw-semibold text-secondary">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
            {{ form.phone }}
          </div>
        </div>
      </div>
    </div>

    <!-- üî∏ ‡∏Å‡∏≤‡∏£‡πå‡∏î: ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà -->
    <div class="card border-0 shadow-sm rounded-4">
      <div class="card-body p-4">
        <h5 class="fw-bold text-success mb-4">
          <i class="fa fa-home me-2"></i> ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠/‡∏à‡∏±‡∏î‡∏™‡πà‡∏á
        </h5>

        <div class="row g-4">
          <div class="col-md-3 col-sm-6">
            <label class="form-label fw-semibold text-secondary">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡πâ‡∏≤‡∏ô</label>
            {{ form.house_no }}
          </div>
          <div class="col-md-2 col-sm-6">
            <label class="form-label fw-semibold text-secondary">‡∏´‡∏°‡∏π‡πà</label>
            {{ form.moo }}
          </div>
          <div class="col-md-7">
            <label class="form-label fw-semibold text-secondary">‡∏ñ‡∏ô‡∏ô</label>
            {{ form.street }}
          </div>

          <div class="col-md-6">
            <label class="form-label fw-semibold text-secondary">‡πÅ‡∏Ç‡∏ß‡∏á/‡∏ï‡∏≥‡∏ö‡∏•</label>
            {{ form.subdistrict }}
          </div>
          <div class="col-md-6">
            <label class="form-label fw-semibold text-secondary">‡πÄ‡∏Ç‡∏ï/‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</label>
            {{ form.district }}
          </div>
          <div class="col-md-6">
            <label class="form-label fw-semibold text-secondary">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</label>
            {{ form.province }}
          </div>
          <div class="col-md-6">
            <label class="form-label fw-semibold text-secondary">‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå</label>
            {{ form.postal_code }}
          </div>
        </div>
      </div>
    </div>

    <div class="text-end mt-4">
      <button type="submit" class="btn btn-success px-4 py-2 fw-semibold shadow-sm rounded-3">
        <i class="fa fa-save me-2"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
      </button>
    </div>
  </form>
  {% endif %}
</div>

<!-- üé® Custom Style -->
<style>
  body {
    background-color: #f8f9fa;
  }

  .card {
    border-radius: 16px;
  }

  input, select {
    border-radius: 10px !important;
    border: 1px solid #ccc !important;
    padding: 10px 12px !important;
    transition: all 0.2s ease-in-out;
  }

  input:focus, select:focus {
    border-color: #198754 !important;
    box-shadow: 0 0 4px rgba(25, 135, 84, 0.4) !important;
    outline: none !important;
  }

  label.form-label {
    margin-bottom: 4px;
  }

  .btn-success {
    background-color: #198754 !important;
    border-color: #198754 !important;
    transition: all 0.2s ease-in-out;
  }

  .btn-success:hover {
    background-color: #157347 !important;
    box-shadow: 0 3px 6px rgba(25, 135, 84, 0.3);
  }

  /* üì± Responsive */
  @media (max-width: 768px) {
    .card-body {
      padding: 1.5rem !important;
    }

    h5 {
      font-size: 1.1rem;
    }

    .btn {
      width: 100%;
    }

    /* ‡πÉ‡∏´‡πâ‡∏ä‡∏∑‡πà‡∏≠‚Äì‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ô‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
    .d-flex.flex-sm-row {
      flex-direction: row !important;
    }
  }
</style>
{% endblock %}
