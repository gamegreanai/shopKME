{% extends 'base/base.html' %}
{% load static %}
{% block title %}DDreamclinic{% endblock %}

{% block content %}
<div class="main-wrapper">
  {% comment %} <!--  Navbar --> {% endcomment %}
  {% include 'base/navbar.html' %}

  {% comment %} <!--  Sidebar --> {% endcomment %}
  {% include 'account/sidebar_profile.html' %}

  {% comment %} <!--  เนื้อหา (Redeem หรือ Dashboard) --> {% endcomment %}
  <div class="main-content container-fluid py-4">
    <div class="card border-0 shadow-sm rounded-4 mb-4">
      <div class="card-body d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3">
        <div>
          <span class="badge bg-success rounded-pill px-3 py-2 fs-6">
            ระดับสมาชิก: {{ meter.level }}
          </span>
          <span class="ms-2 text-muted">
            แต้มสะสม: <strong>{{ meter.points|default:0 }}</strong> pts
          </span>
        </div>
        <div class="progress-wrapper w-100 w-md-50" style="max-width: 520px;">
          <div class="d-flex justify-content-between small mb-1">
            <span>{{ meter.level }}</span>
            <span>{{ meter.progress_pct }}%</span>
          </div>
          <div class="progress" style="height: 10px;">
            <div class="progress-bar bg-success" style="width: {{ meter.progress_pct }}%;"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

{% comment %} <!--  CSS ปรับ Layout ให้สมบูรณ์ --> {% endcomment %}
<style>
  body {
    background-color: #f8f9fa;
    margin: 0;
    padding: 0;
    overflow-x: hidden;
  }

  {% comment %} /*  จัด Layout รวมทั้งหมด */ {% endcomment %}
  .main-wrapper {
    display: flex;
    flex-direction: column;
    width: 100%;
  }

  {% comment %} /*  Navbar */ {% endcomment %}
  .navbar {
    position: fixed !important;
    top: 0;
    left: 0;
    width: 100%;
    height: 110px;
    z-index: 1100;
  }

  {% comment %} /*  Sidebar */ {% endcomment %}
  .sidebar {
    position: fixed !important;
    top: 110px; /* อยู่ใต้ Navbar */
    left: 0;
    width: 280px;
    height: calc(100vh - 110px);
    background-color: #fff;
    border-right: 1px solid #ddd;
    overflow-y: auto;
    z-index: 1040;
  }

  {% comment %} /*  เนื้อหา */ {% endcomment %}
  .main-content {
    margin-top: 130px; /* ป้องกัน Navbar ทับ */
    margin-left: 280px; /* ป้องกัน Sidebar ทับ */
    padding: 2rem;
    transition: all 0.3s ease;
  }

  {% comment %} /*  Responsive (Tablet / Mobile) */ {% endcomment %}
  @media (max-width: 991px) {
    .sidebar {
      display: none !important;
    }

    .main-content {
      margin-left: 0 !important;
      margin-top: 120px !important;
      padding: 1rem;
    }
  }

  @media (max-width: 768px) {
    .navbar {
      height: 90px;
    }

    .main-content {
      margin-top: 100px !important;
      padding: 0.8rem;
    }
  }

  {% comment %} /*  ปรับขนาดองค์ประกอบตามหน้าจอจริง */ {% endcomment %}
  .card {
    border-radius: clamp(10px, 2vw, 18px);
  }

  .badge {
    font-size: clamp(0.8rem, 2vw, 1rem);
    padding: clamp(0.3rem, 1vw, 0.6rem) clamp(0.8rem, 2vw, 1.2rem);
  }

  .progress {
    height: clamp(8px, 1vw, 12px);
  }

  .progress-bar {
    transition: width 0.5s ease-in-out;
  }

  span, p, h5, h6 {
    font-size: clamp(0.9rem, 2vw, 1.2rem);
  }
</style>
{% endblock %}
